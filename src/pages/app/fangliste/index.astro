---
import Site from "../../../layouts/Site.astro";
import { APP } from "../../../config/app";
---

<Site title={`Fangliste • ${APP.name}`} description="Digitale Fangliste" robots="noindex">
  <section class="card">
    <div class="card__body">
      <h1>Fangliste / Angeltage</h1>
      <p class="small">Klicke auf eine Zeile für Details. Bilder können im Dialog hinterlegt werden.</p>

      <div class="fangliste-actions">
        <button type="button" id="tripOpenCreate" class="feed-btn feed-btn--ghost">Eintrag erfassen</button>
        <button type="button" id="tripQuickNoCatch" class="feed-btn">Kein Fang</button>
      </div>

      <p id="tripMsg" class="small" aria-live="polite"></p>
    </div>
  </section>

  <section class="card">
    <div class="card__body">
      <h2>Meine Angeltage</h2>

      <div class="ui-container-toolbar">
        <div class="ui-view-toggle" role="group" aria-label="Ansicht">
          <button type="button" class="feed-btn" id="tripViewZeileBtn" data-ansicht="zeile">Ansicht Zeile</button>
          <button type="button" class="feed-btn feed-btn--ghost" id="tripViewKarteBtn" data-ansicht="karte">Ansicht Karte</button>
        </div>
        <input id="tripSearch" type="search" placeholder="Suche Tag, Gewässer, Fang" />
        <button type="button" class="feed-btn feed-btn--ghost" id="tripColumnsToggleBtn" aria-expanded="false">Spalten und Filter</button>
      </div>

      <label class="fangliste-filter">
        <input id="tripOnlyNoCatch" type="checkbox" /> Nur Kein Fang
      </label>

      <div id="tripColumnsPanel" class="ui-column-panel hidden" hidden>
        <div class="ui-column-panel__block">
          <h3>Spalten anzeigen</h3>
          <div id="tripColumnVisibility" class="ui-column-list"></div>
        </div>
        <div class="ui-column-panel__block">
          <h3>Spaltenreihenfolge</h3>
          <div id="tripColumnOrder" class="ui-column-list"></div>
        </div>
        <div class="ui-column-panel__block">
          <h3>Filter pro Spalte</h3>
          <div id="tripColumnFilters" class="ui-filter-row"></div>
        </div>
      </div>

      <div id="tripList" class="fangliste-list" style="margin-top:10px"></div>
    </div>
  </section>

  <section class="card">
    <div class="card__body">
      <h2>Meine Stats</h2>
      <p class="small">Deine Angeltage, Kein-Fang-Tage, Gesamtfänge und letzter Eintrag.</p>
      <p id="tripStatsMsg" class="small" aria-live="polite"></p>
      <div id="tripStatsBox" class="fangliste-list"></div>
    </div>
  </section>

  <dialog id="tripCreateDialog" class="catch-dialog">
    <form id="tripCreateForm" class="catch-dialog__form" method="dialog">
      <h3 id="tripCreateTitle">Eintrag erfassen</h3>

      <div class="fangliste-form-grid">
        <label>
          <span>Datum</span>
          <input id="tripDate" type="date" required />
        </label>

        <label>
          <span>Gewässer suchen</span>
          <input id="tripWaterSearch" type="search" placeholder="Gewässer filtern..." />
        </label>

        <label class="fangliste-full">
          <span>Gewässer</span>
          <select id="tripWater" required></select>
        </label>

        <label class="fangliste-catch-only">
          <span>Fischart (optional)</span>
          <select id="tripFishSpecies"></select>
        </label>

        <label class="fangliste-catch-only">
          <span>Anzahl (optional, Standard 1)</span>
          <input id="tripQty" type="number" min="1" step="1" value="1" />
        </label>

        <label class="fangliste-catch-only">
          <span>Länge in cm (optional)</span>
          <input id="tripLength" type="number" min="0" step="0.1" />
        </label>

        <label class="fangliste-catch-only">
          <span>Gewicht in g (optional)</span>
          <input id="tripWeight" type="number" min="0" step="1" />
        </label>

        <label class="fangliste-full">
          <span>Bild (optional)</span>
          <input id="tripCreatePhoto" type="file" accept="image/*" />
        </label>
      </div>

      <div class="catch-dialog__actions">
        <button type="submit" id="tripCreateSubmit" class="feed-btn">Speichern</button>
        <button type="button" id="tripCreateClose" class="feed-btn feed-btn--ghost">Schließen</button>
      </div>
      <p id="tripCreateMsg" class="small" aria-live="polite"></p>
    </form>
  </dialog>

  <dialog id="tripDetailDialog" class="catch-dialog">
    <form id="tripDetailForm" class="catch-dialog__form" method="dialog">
      <h3>Eintragsdetails</h3>
      <div id="tripDetailBody" class="catch-dialog__body"></div>
      <div class="catch-dialog__actions">
        <button type="button" id="tripDeleteEntryBtn" class="feed-btn feed-btn--ghost">Eintrag löschen</button>
        <button type="button" id="tripDetailSaveChanges" class="feed-btn">Änderungen speichern</button>
        <button type="button" id="tripDetailClose" class="feed-btn feed-btn--ghost">Schließen</button>
      </div>
      <p id="tripDetailMsg" class="small" aria-live="polite"></p>
    </form>
  </dialog>

  <script src="/js/catchlist.js" defer></script>
</Site>
