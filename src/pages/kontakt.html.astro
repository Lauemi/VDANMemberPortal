---
import Site from "../layouts/Site.astro";
import { APP } from "../config/app";

const turnstileSiteKey = import.meta.env.PUBLIC_TURNSTILE_SITE_KEY ?? "";
---

<Site title={`Kontakt • ${APP.name}`} description="Kontaktformular für den VDAN Ottenheim.">
  <section class="card">
    <div class="card__body">
      <h1>Kontakt</h1>
      <p class="small">Kontaktanfragen werden erst nach E-Mail-Bestätigung weitergeleitet.</p>
      <p id="contactFormMsg" class="small" aria-live="polite"></p>

      <form id="contact" class="grid cols2" novalidate>
        <label>Anrede
          <select name="salut" id="salut">
            <option disabled selected value="">Bitte wählen</option>
            <option>Frau</option>
            <option>Herr</option>
          </select>
        </label>
        <label>Nachname
          <input type="text" name="lname" id="lname" required placeholder="Nachname" maxlength="40" />
        </label>
        <label>Vorname
          <input type="text" name="name" id="fname" required placeholder="Vorname" maxlength="40" />
        </label>
        <label>E-Mail
          <input type="email" id="email" name="email" required placeholder="E-Mail" maxlength="50" />
        </label>
        <label>Betreff
          <input type="text" id="subject" name="subject" required placeholder="Betreff" maxlength="120" />
        </label>
        <label>Telefon
          <input type="tel" id="phone" name="phone" placeholder="Telefonnummer" maxlength="20" />
        </label>
        <label style="grid-column:1 / -1;">Ihre Nachricht
          <textarea name="message" id="message" required placeholder="Ihre Nachricht an uns" rows="10" maxlength="2500"></textarea>
        </label>
        <input type="text" name="company" id="hpCompany" tabindex="-1" autocomplete="off" style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;" />

        <div style="grid-column:1 / -1;">
          {turnstileSiteKey ? (
            <div class="cf-turnstile" data-sitekey={turnstileSiteKey} data-callback="onTurnstileDone"></div>
          ) : (
            <p class="small" style="color:#fecaca;">Turnstile Site Key fehlt (`PUBLIC_TURNSTILE_SITE_KEY`).</p>
          )}
        </div>

        <div style="grid-column:1 / -1;display:flex;justify-content:flex-start;">
          <button type="submit" id="button" name="button" class="feed-btn">Absenden & bestätigen</button>
        </div>
      </form>

      <p class="small">* Pflichtfelder. Kein Direktversand per E-Mail aus dem Browser.</p>
    </div>
  </section>

  {turnstileSiteKey && <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>}
  <script src="/js/contact-submit.js" defer></script>
</Site>
