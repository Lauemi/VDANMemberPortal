---
import Site from "../layouts/Site.astro";
import { APP } from "../config/app";

const nextRaw = Astro.url.searchParams.get("next") ?? "/";
const nextTarget = nextRaw.startsWith("/") ? nextRaw : "/";
const showDemoHint = Boolean(import.meta.env.DEV);
const enablePasswordReset = String(import.meta.env.PUBLIC_ENABLE_PASSWORD_RESET || "").toLowerCase() === "true";
---

<Site title={`Login â€¢ ${APP.name}`} description="Login zum Memberbereich." robots="noindex">
  <section class="card" style="max-width:520px;margin:0 auto;">
    <div class="card__body">
      <h1>Login</h1>
      <p class="small">Bitte Mitgliedsnummer zum login verwenden. Das Passwort Erstpasswort wird vom Vorstand bei Fortschritt der Tests ausgegeben. 
      </p>

      <form id="loginForm" data-next-target={nextTarget}>
        <label>
          <span>Mitgliedsnummer</span>
          <input id="loginMemberNo" name="member_no" type="text" inputmode="numeric" autocomplete="username" required />
        </label>
        <label>
          <span>Passwort</span>
          <input id="loginPass" name="password" type="password" autocomplete="current-password" required />
        </label>

        <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <button class="primary" type="submit">Einloggen</button>
          <span id="loginMsg" class="small" aria-live="polite"></span>
        </div>
      </form>

      <p class="small" style="margin-top:10px;">
        {enablePasswordReset
          ? <a href="/passwort-vergessen/">Passwort vergessen?</a>
          : "Passwort vergessen ist vorbereitet, aber aktuell noch deaktiviert."}
      </p>

      {showDemoHint && (
        <>
          <hr />
          
        </>
      )}
    </div>
  </section>

</Site>
