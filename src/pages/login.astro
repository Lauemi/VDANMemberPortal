---
import Site from "../layouts/Site.astro";
import { APP } from "../config/app";

const nextRaw = Astro.url.searchParams.get("next") ?? "/app/";
const nextTarget = nextRaw.startsWith("/") ? nextRaw : "/app/";
const showDemoHint = Boolean(import.meta.env.DEV);
---

<Site title={`Login • ${APP.name}`} description="Login zum Memberbereich." robots="noindex">
  <section class="card" style="max-width:520px;margin:0 auto;">
    <div class="card__body">
      <h1>Login</h1>
      <p class="small">Mitgliedsnummer + Passwort. Beim ersten Login mit Standardpasswort musst du dein Passwort ändern.</p>

      <form id="loginForm" data-next-target={nextTarget}>
        <label>
          <span>Mitgliedsnummer</span>
          <input id="loginMemberNo" name="member_no" type="text" inputmode="numeric" autocomplete="username" required />
        </label>
        <label>
          <span>Passwort</span>
          <input id="loginPass" name="password" type="password" autocomplete="current-password" required />
        </label>

        <div style="display:flex;gap:10px;align-items:center;flex-wrap:wrap">
          <button class="primary" type="submit">Einloggen</button>
          <span id="loginMsg" class="small" aria-live="polite"></span>
        </div>
      </form>

      {showDemoHint && (
        <>
          <hr />
          <p class="small">Hinweis: Demo-User nutzen Mitgliedsnummern ab 9990.</p>
        </>
      )}
    </div>
  </section>

</Site>
